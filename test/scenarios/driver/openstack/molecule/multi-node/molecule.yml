---
dependency:
  name: galaxy
driver:
  name: openstack
lint:
  name: yamllint
  options:
    config-file: ../../../resources/.yamllint
platforms:
  - name: instance-1
    groups:
      - foo
      - bar
  - name: instance-2
    groups:
      - foo
      - baz
provisioner:
  name: ansible
  playbooks:
    create: ../../../../../resources/playbooks/openstack/create.yml
    destroy: ../../../../../resources/playbooks/openstack/destroy.yml
  env:
    ANSIBLE_ROLES_PATH: ../../../../../resources/roles/
  inventory:
    group_vars:
      all:
        ssh_user: cloud-user
        ssh_port: 22
        security_group_name: molecule
        security_group_description: "Security group for testing Molecule"
        security_group_rules:
          - proto: tcp
            port: "{{ ssh_port }}"
            cidr: '0.0.0.0/0'
          - proto: icmp
            port: -1
            cidr: '0.0.0.0/0'
          - ethertype: IPv4
            group: "{{ security_group.id }}"
          - ethertype: IPv6
            group: "{{ security_group.id }}"
        neutron_network_name: molecule
        keypair_name: molecule_key
        keypair_path: "{{ lookup('env', 'MOLECULE_EPHEMERAL_DIRECTORY') }}/ssh_key"
        nova_image: Ubuntu-16.04
        nova_flavor: NO-Nano
  lint:
    name: ansible-lint
scenario:
  name: multi-node
verifier:
  name: testinfra
  lint:
    name: flake8
